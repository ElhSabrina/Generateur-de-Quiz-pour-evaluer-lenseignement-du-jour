//- views/teacher/quiz_analysis.pug
extends ../layout

block content
  h1 Quiz analysis
  .card
    h2 Summary
    p Average score: #{Math.round(avgScore)} points
    p.small-text Total attempts: #{totalAttempts}
    if weakQuestions && weakQuestions.length
      h3 Weak questions (less than 60% correct)
      ul
        each w in weakQuestions
          li= w.text
      p.reco
        | Next class, re-explain these points slowly and check again with a short activity.
    else if totalAttempts > 0
      p Students performed well on this quiz. You can move to more advanced concepts.
    else
      p No answers yet. Ask students to complete the quiz first.

  .card
    h2 Details per question
    if questionStats && questionStats.length
      table.table
        thead
          tr
            th Question
            th Correct answers
            th Total answers
            th Rate
        tbody
          each q in questionStats
            - const total = q.total_answers || 0;
            - const correct = q.correct_count || 0;
            - const rate = total > 0 ? Math.round((correct / total) * 100) : 0;
            tr
              td= q.text
              td= correct
              td= total
              td #{rate} %
    else
      p.small-text No questions statistics available.
